<div class="admin-container">
  <!-- features/admin/dashboard/dashboard.component.html -->
  <div class="admin-header">
    <h1>ğŸ›ï¸ Panel de AdministraciÃ³n - Mundial 2026</h1>
    <p class="subtitle">Enviar eventos al sistema en tiempo real</p>
  </div>

  <!-- Main Content -->
  <div class="admin-content">
    <!-- Control Panel -->
    <div class="control-panel">
      <h2>ğŸ“¤ Enviar Evento</h2>

      <!-- Selector de tipo de evento -->
      <div class="event-type-selector">
        <button 
          *ngFor="let type of ['goal', 'card', 'substitution', 'match-status']"
          [class.active]="eventType === type"
          (click)="eventType = type"
          class="event-type-btn">
          {{ type === 'goal' ? 'âš½ Gol' :
             type === 'card' ? 'ğŸŸ¨ Tarjeta' :
             type === 'substitution' ? 'ğŸ”„ Cambio' :
             'â±ï¸ Estado' }}
        </button>
      </div>

      <!-- Formulario comÃºn -->
      <div class="match-info-section">
        <h3>ğŸŸï¸ Seleccionar Partido</h3>
        
        <div class="form-group">
          <label>Partido:</label>
          <select [(ngModel)]="eventForm.matchId" (change)="onMatchChange()" class="form-control match-select-big">
            <option *ngFor="let match of availableMatches" [value]="match.id">
              {{ match.label }}
            </option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label>â±ï¸ Minuto:</label>
        <input type="number" [(ngModel)]="eventForm.minute" class="form-control" min="0" max="120">
      </div>

      <div class="form-group">
        <label>ğŸ‘• Equipo del Evento:</label>
        <select [(ngModel)]="eventForm.team" class="form-control">
          <option [value]="selectedMatch.homeTeam">
            {{ getTeamFlag(selectedMatch.homeTeam) }} {{ selectedMatch.homeTeam }} (Local)
          </option>
          <option [value]="selectedMatch.awayTeam">
            {{ getTeamFlag(selectedMatch.awayTeam) }} {{ selectedMatch.awayTeam }} (Visitante)
          </option>
        </select>
      </div>

      <!-- Formulario especÃ­fico para GOL -->
      <div *ngIf="eventType === 'goal'" class="event-form">
        <div class="form-group">
          <label>âš½ Jugador que anota:</label>
          <select [(ngModel)]="eventForm.player" class="form-control">
            <option value="">Selecciona un jugador</option>
            <option *ngFor="let player of getPlayersForTeam()" [value]="player">
              {{ player }}
            </option>
          </select>
        </div>

        <div class="score-group">
          <div class="form-group">
            <label>{{ getTeamFlag(selectedMatch.homeTeam) }} {{ selectedMatch.homeTeam }} (Local):</label>
            <input type="number" [(ngModel)]="eventForm.score!.home" class="form-control" min="0">
          </div>
          <div class="form-group">
            <label>{{ getTeamFlag(selectedMatch.awayTeam) }} {{ selectedMatch.awayTeam }} (Visitante):</label>
            <input type="number" [(ngModel)]="eventForm.score!.away" class="form-control" min="0">
          </div>
        </div>

        <button (click)="sendGoal()" [disabled]="isLoading || !eventForm.player" class="submit-btn goal-btn">
          âš½ Enviar Gol
        </button>
      </div>

      <!-- Formulario especÃ­fico para TARJETA -->
      <div *ngIf="eventType === 'card'" class="event-form">
        <div class="form-group">
          <label>Jugador:</label>
          <select [(ngModel)]="eventForm.player" class="form-control">
            <option value="">Selecciona un jugador</option>
            <option *ngFor="let player of getPlayersForTeam()" [value]="player">
              {{ player }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>Tipo de Tarjeta:</label>
          <select [(ngModel)]="eventForm.cardType" class="form-control">
            <option value="">Selecciona tipo</option>
            <option *ngFor="let card of cardTypes" [value]="card">
              {{ card === 'yellow' ? 'ğŸŸ¨ Amarilla' : 'ğŸŸ¥ Roja' }}
            </option>
          </select>
        </div>

        <button (click)="sendCard()" [disabled]="isLoading || !eventForm.player || !eventForm.cardType" class="submit-btn card-btn">
          ğŸŸ¨ Enviar Tarjeta
        </button>
      </div>

      <!-- Formulario especÃ­fico para CAMBIO -->
      <div *ngIf="eventType === 'substitution'" class="event-form">
        <div class="form-group">
          <label>Jugador que SALE:</label>
          <select [(ngModel)]="eventForm.playerOut" class="form-control">
            <option value="">Selecciona jugador</option>
            <option *ngFor="let player of getPlayersForTeam()" [value]="player">
              {{ player }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>Jugador que ENTRA:</label>
          <select [(ngModel)]="eventForm.playerIn" class="form-control">
            <option value="">Selecciona jugador</option>
            <option *ngFor="let player of getPlayersForTeam()" [value]="player">
              {{ player }}
            </option>
          </select>
        </div>

        <button (click)="sendSubstitution()" [disabled]="isLoading || !eventForm.playerOut || !eventForm.playerIn" class="submit-btn sub-btn">
          ğŸ”„ Enviar Cambio
        </button>
      </div>

      <!-- Formulario especÃ­fico para ESTADO -->
      <div *ngIf="eventType === 'match-status'" class="event-form">
        <div class="form-group">
          <label>Estado del Partido:</label>
          <select [(ngModel)]="eventForm.status" class="form-control">
            <option value="">Selecciona estado</option>
            <option *ngFor="let status of matchStatuses" [value]="status">
              {{ status === 'first_half_start' ? 'â±ï¸ Inicio 1er Tiempo' :
                 status === 'half_time' ? 'â˜• Medio Tiempo' :
                 status === 'second_half_start' ? 'â±ï¸ Inicio 2do Tiempo' :
                 'ğŸ Final' }}
            </option>
          </select>
        </div>

        <button (click)="sendMatchStatus()" [disabled]="isLoading || !eventForm.status" class="submit-btn status-btn">
          â±ï¸ Enviar Estado
        </button>
      </div>

      <!-- Loading & Response -->
      <div *ngIf="isLoading" class="loading">
        <div class="spinner"></div>
        <p>Enviando evento...</p>
      </div>

      <div *ngIf="lastResponse && !isLoading" class="response-box success">
        <strong>âœ… Evento Enviado Correctamente</strong>
        <pre>{{ lastResponse | json }}</pre>
      </div>

      <div *ngIf="errorMessage && !isLoading" class="response-box error">
        <strong>âŒ Error al Enviar Evento</strong>
        <p>{{ errorMessage }}</p>
      </div>
    </div>

    <!-- Event History -->
    <div class="history-panel">
      <div class="history-header">
        <h2>ğŸ“‹ Historial de Eventos Enviados</h2>
        <button *ngIf="sentEvents.length > 0" (click)="clearHistory()" class="clear-history-btn">
          ğŸ—‘ï¸ Limpiar
        </button>
      </div>

      <div class="history-list">
        <div *ngIf="sentEvents.length === 0" class="no-history">
          <p>ğŸ“­ No hay eventos en el historial</p>
        </div>

        <div *ngFor="let event of sentEvents; let i = index" class="history-item">
          <div class="history-header-item">
            <span class="history-type">
              {{ event.type === 'goal' ? 'âš½' :
                 event.type === 'card' ? 'ğŸŸ¨' :
                 event.type === 'substitution' ? 'ğŸ”„' :
                 'â±ï¸' }}
              {{ event.type }}
            </span>
            <span class="history-time">{{ event.timestamp | date:'HH:mm:ss' }}</span>
          </div>
          <div class="history-details">
            <strong>Payload:</strong>
            <pre>{{ event.payload | json }}</pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <h3>âš¡ Acciones RÃ¡pidas</h3>
    <div class="quick-buttons">
      <button (click)="eventType = 'goal'; eventForm.player = 'Paolo Guerrero'; eventForm.team = 'Peru'" class="quick-btn">
        âš½ Gol de Guerrero
      </button>
      <button (click)="eventType = 'goal'; eventForm.player = 'Lionel Messi'; eventForm.team = 'Argentina'" class="quick-btn">
        âš½ Gol de Messi
      </button>
      <button (click)="eventType = 'match-status'; eventForm.status = 'first_half_start'" class="quick-btn">
        â±ï¸ Iniciar Partido
      </button>
      <button (click)="eventType = 'match-status'; eventForm.status = 'full_time'" class="quick-btn">
        ğŸ Finalizar Partido
      </button>
    </div>
  </div>
</div>
